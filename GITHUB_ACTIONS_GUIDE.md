# 🚀 راهنمای تنظیم GitHub Actions

این راهنما به شما کمک می‌کند تا ربات خبرخوان را بدون نیاز به سرور، فقط با GitHub Actions اجرا کنید.

## 📋 مراحل تنظیم

### 1️⃣ Fork کردن پروژه
- به صفحه پروژه در GitHub بروید
- روی دکمه **Fork** کلیک کنید
- پروژه در اکانت شما کپی می‌شود

### 2️⃣ تنظیم Secrets و Variables

#### 🔐 Secrets (اطلاعات محرمانه)
به `Settings > Secrets and variables > Actions` بروید و Secrets زیر را اضافه کنید:

| نام Secret | توضیحات | مثال |
|------------|---------|------|
| `OPENROUTER_API_KEY` | کلید API از OpenRouter | `sk-or-v1-xxx...` |
| `TELEGRAM_BOT_TOKEN` | توکن ربات تلگرام | `1234567890:ABC...` |
| `TELEGRAM_CHAT_ID` | شناسه کانال/گروه | `-1001234567890` |

#### 🔧 Variables (تنظیمات عمومی)
در همان صفحه، تب **Variables** را انتخاب کنید:

| نام Variable | توضیحات | مقدار پیش‌فرض |
|-------------|---------|---------------|
| `NEWS_SITE_1` | سایت خبری اول | `https://pedal.ir` |
| `NEWS_SITE_2` | سایت خبری دوم | `https://www.motor1.com` |
| `NEWS_SITE_3` | سایت خبری سوم | `https://www.autocar.co.uk` |
| `AI_MODEL` | مدل هوش مصنوعی | `google/gemini-2.0-flash-exp:free` |

### 3️⃣ فعال‌سازی Actions

1. به تب **Actions** در repository خود بروید
2. اگر Actions غیرفعال است، روی **Enable** کلیک کنید
3. Workflow های موجود را مشاهده خواهید کرد:
   - `News Scraper Bot`: اجرای اصلی ربات
   - `Test News Scraper`: تست عملکرد

### 4️⃣ اجرای دستی (تست)

برای تست اولیه:
1. به تب **Actions** بروید
2. روی workflow **News Scraper Bot** کلیک کنید
3. روی **Run workflow** کلیک کنید
4. **Run workflow** را دوباره کلیک کنید

## ⏰ زمان‌بندی خودکار

ربات به صورت پیش‌فرض روزانه 3 بار اجرا می‌شود (به وقت ایران):
- **8:00 صبح** - اخبار صبحگاهی
- **2:00 بعدازظهر** - اخبار ظهر
- **8:00 شب** - اخبار شب

برای تغییر زمان‌بندی:

1. فایل `.github/workflows/news-scraper.yml` را ویرایش کنید
2. بخش `cron` را تغییر دهید:

```yaml
schedule:
  # زمان‌های فعلی (وقت ایران)
  - cron: '30 4 * * *'   # 8:00 صبح ایران
  - cron: '30 10 * * *'  # 2:00 ظهر ایران  
  - cron: '30 16 * * *'  # 8:00 شب ایران
  
  # مثال‌های دیگر:
  # - cron: '0 5 * * *'    # 8:30 صبح ایران
  # - cron: '30 8 * * *'   # 12:00 ظهر ایران
  # - cron: '0 18 * * *'   # 9:30 شب ایران
```

### 📅 راهنمای تبدیل وقت:
**نکته مهم**: GitHub Actions از UTC استفاده می‌کند، ایران UTC+3:30 است.

| وقت ایران | UTC | Cron |
|-----------|-----|------|
| 6:00 صبح | 2:30 | `30 2 * * *` |
| 8:00 صبح | 4:30 | `30 4 * * *` |
| 12:00 ظهر | 8:30 | `30 8 * * *` |
| 2:00 ظهر | 10:30 | `30 10 * * *` |
| 6:00 شب | 14:30 | `30 14 * * *` |
| 8:00 شب | 16:30 | `30 16 * * *` |
| 10:00 شب | 18:30 | `30 18 * * *` |

## 🔍 نظارت و عیب‌یابی

### مشاهده لاگ‌ها:
1. به تب **Actions** بروید
2. روی آخرین اجرا کلیک کنید
3. روی job **scrape-news** کلیک کنید
4. لاگ‌های تفصیلی را مشاهده کنید

### مشکلات رایج:

#### ❌ خطای API Key
```
API error: 401 - Unauthorized
```
**راه‌حل**: کلید `OPENROUTER_API_KEY` را بررسی کنید

#### ❌ خطای تلگرام
```
Telegram send failed
```
**راه‌حل**: `TELEGRAM_BOT_TOKEN` و `TELEGRAM_CHAT_ID` را بررسی کنید

#### ❌ عدم یافتن اخبار
```
No news found
```
**راه‌حل**: سایت‌های خبری را بررسی کنید یا سایت‌های جدید اضافه کنید

## 💾 مدیریت دیتابیس

GitHub Actions دیتابیس را به صورت خودکار بین اجراها حفظ می‌کند:
- دیتابیس به عنوان **Artifact** ذخیره می‌شود
- مدت نگهداری: 90 روز
- نام Artifact: `news-database-{username}`

## 🔧 تنظیمات پیشرفته

### اضافه کردن سایت‌های بیشتر:
```yaml
NEWS_SITE_4: "https://example.com"
NEWS_SITE_5: "https://another-site.com"
# تا NEWS_SITE_20
```

### تغییر مدل AI:
```yaml
AI_MODEL: "anthropic/claude-3-haiku"
# یا
AI_MODEL: "openai/gpt-3.5-turbo"
```

### تنظیم پرامپت‌های سفارشی:
```yaml
AI_SELECTION_PROMPT: "پرامپت سفارشی برای انتخاب اخبار"
AI_SUMMARIZATION_PROMPT: "پرامپت سفارشی برای خلاصه‌سازی"
AI_TRANSLATION_PROMPT: "پرامپت سفارشی برای ترجمه"
```

## 📊 محدودیت‌ها

### GitHub Actions:
- حداکثر 2000 دقیقه در ماه (رایگان)
- هر اجرا حدود 2-5 دقیقه طول می‌کشد
- حداکثر 20 اجرا همزمان

### OpenRouter API:
- محدودیت‌های مدل‌های رایگان
- Rate limiting برای درخواست‌های زیاد

## 🆘 پشتیبانی

اگر مشکلی داشتید:
1. لاگ‌های Actions را بررسی کنید
2. Issue جدید در GitHub ایجاد کنید
3. تنظیمات Secrets و Variables را دوباره بررسی کنید

---

**نکته مهم**: این راهنما برای استفاده شخصی طراحی شده. برای استفاده تجاری، محدودیت‌های GitHub Actions و API ها را در نظر بگیرید.